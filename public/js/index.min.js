const xhr=(url,method="POST")=>{const req=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");req.open(method,url);return req};(()=>{const join=username=>{const req=xhr("/join");req.onreadystatechange=(()=>{if(req.readyState===4){if(req.status===200){try{const response=JSON.parse(req.responseText);if(response.error)changeWarning(response.msg)}catch(e){document.open();document.write(req.responseText);document.close();return}}else if(req.status===403)changeWarning("Deja ahí chamaco");else changeWarning("Algo salió mal")}});req.setRequestHeader("Content-Type","application/json;charset=utf8");req.send(JSON.stringify({username:username}))};const changeWarning=msg=>{warning.hidden=false;document.querySelector("#warning-p").textContent=msg};const invalidUsername=username=>{if(username.length===0)return"Escriba un nombre de usuario";if(username.length>50)return"El nombre de usuario no puede exceder los 50 caracteres";if(!/^[a-zA-Zá-úÁ-Úä-üÄ-ÜñÑ 0-9]+$/.test(username))return"Sólo se aceptan caracteres del alfabeto español"};let warning=document.querySelector("#warning");UIkit.alert(warning);document.querySelector("form").addEventListener("submit",function(event){warning.hidden=true;event.preventDefault();const username=this.querySelector("#username").value;const invalid_username=invalidUsername(username);if(invalid_username)changeWarning(invalid_username);join(username);return false});document.querySelector("#username").addEventListener("input",function(){warning.hidden=true;const invalid_username=invalidUsername(this.value);if(invalid_username)changeWarning(invalid_username)})})();